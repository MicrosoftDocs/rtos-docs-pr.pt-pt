---
title: Capítulo 1 - Introdução ao Servidor Azure RTOS NetX DHCP
description: A aplicação estabelece a comunicação com o seu servidor Azure RTOS NetX DHCP para solicitar e obter um endereço IP dinamicamente.
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 17438a20ad3da64c88c3d6bb19a4887c2c6e354e
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 03/22/2021
ms.locfileid: "104826792"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-dhcp-server"></a><span data-ttu-id="60dbc-103">Capítulo 1 - Introdução ao Servidor Azure RTOS NetX DHCP</span><span class="sxs-lookup"><span data-stu-id="60dbc-103">Chapter 1 - Introduction to Azure RTOS NetX DHCP Server</span></span>

<span data-ttu-id="60dbc-104">No NetX, o endereço IP da aplicação é um dos parâmetros fornecidos para a chamada de serviço *nx_ip_create.*</span><span class="sxs-lookup"><span data-stu-id="60dbc-104">In NetX, the application's IP address is one of the supplied parameters to the *nx_ip_create* service call.</span></span> <span data-ttu-id="60dbc-105">O fornecimento do endereço IP não levanta qualquer problema se o endereço IP for conhecido da aplicação, quer estática quer através da configuração do utilizador.</span><span class="sxs-lookup"><span data-stu-id="60dbc-105">Supplying the IP address poses no problem if the IP address is known to the application, either statically or through user configuration.</span></span> <span data-ttu-id="60dbc-106">No entanto, existem alguns casos em que a aplicação não sabe ou se importa com o seu endereço IP.</span><span class="sxs-lookup"><span data-stu-id="60dbc-106">However, there are some instances where the application doesn't know or care what its IP address is.</span></span> <span data-ttu-id="60dbc-107">Nestas situações, deve ser fornecido um endereço IP zero à função *nx_ip_create* e a aplicação estabelece a comunicação com o seu servidor Azure RTOS RTX DHCP para solicitar e obter dinamicamente um endereço IP.</span><span class="sxs-lookup"><span data-stu-id="60dbc-107">In such situations, a zero IP address should be supplied to the *nx_ip_create* function and the application establishes communication with its Azure RTOS NetX DHCP server to dynamically request and obtain an IP address.</span></span>

## <a name="dynamic-ip-address-assignment"></a><span data-ttu-id="60dbc-108">Atribuição dinâmica de endereços IP</span><span class="sxs-lookup"><span data-stu-id="60dbc-108">Dynamic IP Address Assignment</span></span>

<span data-ttu-id="60dbc-109">O serviço básico utilizado para obter um endereço IP dinâmico da rede é o Protocolo de Resolução de Endereços Reversos (RARP).</span><span class="sxs-lookup"><span data-stu-id="60dbc-109">The basic service used to obtain a dynamic IP address from the network is the Reverse Address Resolution Protocol (RARP).</span></span> <span data-ttu-id="60dbc-110">Este protocolo é semelhante ao ARP, exceto que foi concebido para obter um endereço IP para si mesmo em vez de encontrar o endereço MAC para outro nó de rede.</span><span class="sxs-lookup"><span data-stu-id="60dbc-110">This protocol is similar to ARP, except it is designed to obtain an IP address for itself instead of finding the MAC address for another network node.</span></span> <span data-ttu-id="60dbc-111">A mensagem RARP de baixo nível é transmitida na rede local e é da responsabilidade de um servidor na rede responder com uma resposta RARP, que contém um endereço IP atribuído dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="60dbc-111">The low-level RARP message is broadcast on the local network and it is the responsibility of a server on the network to respond with an RARP response, which contains a dynamically allocated IP address.</span></span>

<span data-ttu-id="60dbc-112">Embora a RARP ofereça um serviço de alocação dinâmica de endereços IP, tem várias deficiências.</span><span class="sxs-lookup"><span data-stu-id="60dbc-112">Although RARP provides a service for dynamic allocation of IP addresses, it has several shortcomings.</span></span> <span data-ttu-id="60dbc-113">A deficiência mais gritante é que o RARP apenas fornece uma atribuição dinâmica do endereço IP.</span><span class="sxs-lookup"><span data-stu-id="60dbc-113">The most glaring deficiency is that RARP only provides dynamic allocation of the IP address.</span></span> <span data-ttu-id="60dbc-114">Na maioria das situações, é necessária mais informação para que um dispositivo participe adequadamente numa rede.</span><span class="sxs-lookup"><span data-stu-id="60dbc-114">In most situations, more information is necessary in order for a device to properly participate on a network.</span></span> <span data-ttu-id="60dbc-115">Além de um endereço IP, a maioria dos dispositivos precisa da máscara de rede e do endereço IP gateway.</span><span class="sxs-lookup"><span data-stu-id="60dbc-115">In addition to an IP address, most devices need the network mask and the gateway IP address.</span></span> <span data-ttu-id="60dbc-116">O endereço IP de um servidor DNS e outras informações de rede também podem ser necessários.</span><span class="sxs-lookup"><span data-stu-id="60dbc-116">The IP address of a DNS server and other network information may also be needed.</span></span> <span data-ttu-id="60dbc-117">A RARP não tem a capacidade de fornecer esta informação.</span><span class="sxs-lookup"><span data-stu-id="60dbc-117">RARP does not have the ability to provide this information.</span></span>

## <a name="rarp-alternatives"></a><span data-ttu-id="60dbc-118">Alternativas RARP</span><span class="sxs-lookup"><span data-stu-id="60dbc-118">RARP Alternatives</span></span>

<span data-ttu-id="60dbc-119">Para superar as deficiências da RARP, os investigadores desenvolveram um mecanismo de atribuição de endereços IP mais abrangente chamado Protocolo de Bootstrap (BOOTP).</span><span class="sxs-lookup"><span data-stu-id="60dbc-119">In order to overcome the deficiencies of RARP, researchers developed a more comprehensive IP address allocation mechanism called the Bootstrap Protocol (BOOTP).</span></span> <span data-ttu-id="60dbc-120">Este protocolo tem a capacidade de alocar dinamicamente um endereço IP e também fornecer informações adicionais importantes de rede.</span><span class="sxs-lookup"><span data-stu-id="60dbc-120">This protocol has the ability to dynamically allocate an IP address and also provide additional important network information.</span></span> <span data-ttu-id="60dbc-121">No entanto, o BOOTP tem a desvantagem de ser projetado para configurações de rede estática.</span><span class="sxs-lookup"><span data-stu-id="60dbc-121">However, BOOTP has the drawback of being designed for static network configurations.</span></span> <span data-ttu-id="60dbc-122">Não permite uma atribuição rápida ou automatizada de endereços.</span><span class="sxs-lookup"><span data-stu-id="60dbc-122">It does not allow for quick or automated address assignment.</span></span>

<span data-ttu-id="60dbc-123">É aqui que o Protocolo de Configuração do Anfitrião Dinâmico (DHCP) é extremamente útil.</span><span class="sxs-lookup"><span data-stu-id="60dbc-123">This is where the Dynamic Host Configuration Protocol (DHCP) is extremely useful.</span></span> <span data-ttu-id="60dbc-124">O DHCP foi concebido para alargar a funcionalidade básica do BOOTP para incluir a atribuição de servidores IP completamente automatizados e alocação de endereços IP completamente dinâmicos através da "locação" de um endereço IP a um cliente por um período de tempo especificado.</span><span class="sxs-lookup"><span data-stu-id="60dbc-124">DHCP is designed to extend the basic functionality of BOOTP to include completely automated IP server allocation and completely dynamic IP address allocation through "leasing" an IP address to a client for a specified period of time.</span></span> <span data-ttu-id="60dbc-125">O DHCP também pode ser configurado para alocar endereços IP de forma estática como o BOOTP.</span><span class="sxs-lookup"><span data-stu-id="60dbc-125">DHCP can also be configured to allocate IP addresses in a static manner like BOOTP.</span></span>

## <a name="dhcp-messages"></a><span data-ttu-id="60dbc-126">Mensagens DHCP</span><span class="sxs-lookup"><span data-stu-id="60dbc-126">DHCP Messages</span></span>

<span data-ttu-id="60dbc-127">Embora o DHCP melhore consideravelmente a funcionalidade do BOOTP, o DHCP utiliza o mesmo formato de mensagem que o BOOTP e suporta as mesmas opções de fornecedor que o BOOTP.</span><span class="sxs-lookup"><span data-stu-id="60dbc-127">Although DHCP greatly enhances the functionality of BOOTP, DHCP uses the same message format as BOOTP and supports the same vendor options as BOOTP.</span></span> <span data-ttu-id="60dbc-128">Para desempenhar a sua função, a DHCP introduz sete novas opções específicas do DHCP, da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="60dbc-128">In order to perform its function, DHCP introduces seven new DHCP-specific options, as follows:</span></span>

| <span data-ttu-id="60dbc-129">Opção</span><span class="sxs-lookup"><span data-stu-id="60dbc-129">Option</span></span>     | <span data-ttu-id="60dbc-130">Valor</span><span class="sxs-lookup"><span data-stu-id="60dbc-130">Value</span></span> | <span data-ttu-id="60dbc-131">Origem</span><span class="sxs-lookup"><span data-stu-id="60dbc-131">Origin</span></span>                |
| ---------- | ----- | --------------------- |
| <span data-ttu-id="60dbc-132">DESCUBRA</span><span class="sxs-lookup"><span data-stu-id="60dbc-132">DISCOVER</span></span>   | <span data-ttu-id="60dbc-133">(1)</span><span class="sxs-lookup"><span data-stu-id="60dbc-133">(1)</span></span>   | <span data-ttu-id="60dbc-134">(enviado pelo Cliente DHCP)</span><span class="sxs-lookup"><span data-stu-id="60dbc-134">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="60dbc-135">OFERTA</span><span class="sxs-lookup"><span data-stu-id="60dbc-135">OFFER</span></span>      | <span data-ttu-id="60dbc-136">(2)</span><span class="sxs-lookup"><span data-stu-id="60dbc-136">(2)</span></span>   | <span data-ttu-id="60dbc-137">(enviado pelo Servidor DHCP)</span><span class="sxs-lookup"><span data-stu-id="60dbc-137">(sent by DHCP Server)</span></span> |
| <span data-ttu-id="60dbc-138">PEDIDO</span><span class="sxs-lookup"><span data-stu-id="60dbc-138">REQUEST</span></span>    | <span data-ttu-id="60dbc-139">(3)</span><span class="sxs-lookup"><span data-stu-id="60dbc-139">(3)</span></span>   | <span data-ttu-id="60dbc-140">(enviado pelo Cliente DHCP)</span><span class="sxs-lookup"><span data-stu-id="60dbc-140">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="60dbc-141">DECLÍNIO</span><span class="sxs-lookup"><span data-stu-id="60dbc-141">DECLINE</span></span>    | <span data-ttu-id="60dbc-142">(4)</span><span class="sxs-lookup"><span data-stu-id="60dbc-142">(4)</span></span>   | <span data-ttu-id="60dbc-143">(enviado pelo Cliente DHCP)</span><span class="sxs-lookup"><span data-stu-id="60dbc-143">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="60dbc-144">Rio ACK</span><span class="sxs-lookup"><span data-stu-id="60dbc-144">ACK</span></span>        | <span data-ttu-id="60dbc-145">(5)</span><span class="sxs-lookup"><span data-stu-id="60dbc-145">(5)</span></span>   | <span data-ttu-id="60dbc-146">(enviado pelo Servidor DHCP)</span><span class="sxs-lookup"><span data-stu-id="60dbc-146">(sent by DHCP Server)</span></span> |
| <span data-ttu-id="60dbc-147">NACK</span><span class="sxs-lookup"><span data-stu-id="60dbc-147">NACK</span></span>       | <span data-ttu-id="60dbc-148">(6)</span><span class="sxs-lookup"><span data-stu-id="60dbc-148">(6)</span></span>   | <span data-ttu-id="60dbc-149">(enviado pelo Servidor DHCP)</span><span class="sxs-lookup"><span data-stu-id="60dbc-149">(sent by DHCP Server)</span></span> |
| <span data-ttu-id="60dbc-150">LANÇAMENTO</span><span class="sxs-lookup"><span data-stu-id="60dbc-150">RELEASE</span></span>    | <span data-ttu-id="60dbc-151">(7)</span><span class="sxs-lookup"><span data-stu-id="60dbc-151">(7)</span></span>   | <span data-ttu-id="60dbc-152">(enviado pelo Cliente DHCP)</span><span class="sxs-lookup"><span data-stu-id="60dbc-152">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="60dbc-153">INFORMAR</span><span class="sxs-lookup"><span data-stu-id="60dbc-153">INFORM</span></span>     | <span data-ttu-id="60dbc-154">(8)</span><span class="sxs-lookup"><span data-stu-id="60dbc-154">(8)</span></span>   | <span data-ttu-id="60dbc-155">(enviado pelo Cliente DHCP)</span><span class="sxs-lookup"><span data-stu-id="60dbc-155">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="60dbc-156">FORÇARENEW</span><span class="sxs-lookup"><span data-stu-id="60dbc-156">FORCERENEW</span></span> | <span data-ttu-id="60dbc-157">(9)</span><span class="sxs-lookup"><span data-stu-id="60dbc-157">(9)</span></span>   | <span data-ttu-id="60dbc-158">(enviado pelo Cliente DHCP)</span><span class="sxs-lookup"><span data-stu-id="60dbc-158">(sent by DHCP Client)</span></span> |

## <a name="dhcp-communication"></a><span data-ttu-id="60dbc-159">Comunicação DHCP</span><span class="sxs-lookup"><span data-stu-id="60dbc-159">DHCP Communication</span></span>

<span data-ttu-id="60dbc-160">O Servidor DHCP utiliza o protocolo UDP para receber pedidos do Cliente DHCP e transmitir respostas.</span><span class="sxs-lookup"><span data-stu-id="60dbc-160">The DHCP Server utilizes the UDP protocol to receive DHCP Client requests and transmit responses.</span></span> <span data-ttu-id="60dbc-161">Antes de ter um endereço IP, as mensagens UDP que transportam as informações do DHCP são enviadas e recebidas utilizando o endereço de transmissão IP de 255.255.255.255.255.</span><span class="sxs-lookup"><span data-stu-id="60dbc-161">Prior to having an IP address, UDP messages carrying the DHCP information are sent and received by utilizing the IP broadcast address of 255.255.255.255.</span></span> <span data-ttu-id="60dbc-162">No entanto, se o Cliente souber o endereço do Servidor DHCP, poderá enviar mensagens DHCP utilizando mensagens unicast.</span><span class="sxs-lookup"><span data-stu-id="60dbc-162">However, if the Client knows the address of the DHCP Server it may send DHCP messages using unicast messages.</span></span>

## <a name="dhcp-server-state-machine"></a><span data-ttu-id="60dbc-163">Máquina de estado do servidor DHCP</span><span class="sxs-lookup"><span data-stu-id="60dbc-163">DHCP Server State Machine</span></span>

<span data-ttu-id="60dbc-164">O Servidor DHCP é implementado como uma máquina estatal de duas etapas processada por um fio DHCP interno que é criado durante *nx_dhcp_server_create* processamento.</span><span class="sxs-lookup"><span data-stu-id="60dbc-164">The DHCP Server is implemented as a two-step state machine processed by an internal DHCP thread that is created during *nx_dhcp_server_create* processing.</span></span> <span data-ttu-id="60dbc-165">Os principais estados do Servidor DHCP são 1) recebendo uma mensagem DISCOVER de um cliente DHCP e 2) recebendo uma mensagem REQUEST.</span><span class="sxs-lookup"><span data-stu-id="60dbc-165">The main states of DHCP Server are 1) receiving a DISCOVER message from a DHCP client and 2) receiving a REQUEST message.</span></span>

<span data-ttu-id="60dbc-166">Abaixo estão os correspondentes estados do Cliente DHCP:</span><span class="sxs-lookup"><span data-stu-id="60dbc-166">Below are the corresponding DHCP Client states:</span></span>

- <span data-ttu-id="60dbc-167">**NX_DHCP_STATE_BOOT**: Começando com um endereço IP anterior</span><span class="sxs-lookup"><span data-stu-id="60dbc-167">**NX_DHCP_STATE_BOOT**: Starting with a previous IP address</span></span>
- <span data-ttu-id="60dbc-168">**NX_DHCP_STATE_INIT**: A partir de nenhum valor de endereço IP anterior</span><span class="sxs-lookup"><span data-stu-id="60dbc-168">**NX_DHCP_STATE_INIT**: Starting with no previous IP address value</span></span>
- <span data-ttu-id="60dbc-169">**NX_DHCP_STATE_SELECTING:** À espera de uma resposta de qualquer servidor DHCP</span><span class="sxs-lookup"><span data-stu-id="60dbc-169">**NX_DHCP_STATE_SELECTING**: Waiting for a response from any DHCP server</span></span>
- <span data-ttu-id="60dbc-170">**NX_DHCP_STATE_REQUESTING**: Servidor DHCP identificado, pedido de endereço IP enviado</span><span class="sxs-lookup"><span data-stu-id="60dbc-170">**NX_DHCP_STATE_REQUESTING**: DHCP Server identified, IP address request sent</span></span>
- <span data-ttu-id="60dbc-171">**NX_DHCP_STATE_BOUND**: DhCP IP Address lease estabelecido</span><span class="sxs-lookup"><span data-stu-id="60dbc-171">**NX_DHCP_STATE_BOUND**: DHCP IP Address lease established</span></span>
- <span data-ttu-id="60dbc-172">**NX_DHCP_STATE_RENEWING**: DHCP IP Prazo de renovação do contrato de arrendamento decorrido, pedido de renovação</span><span class="sxs-lookup"><span data-stu-id="60dbc-172">**NX_DHCP_STATE_RENEWING**: DHCP IP Address lease renewal time elapsed, renewal requested</span></span>
- <span data-ttu-id="60dbc-173">**NX_DHCP_STATE_REBINDING**: DHCP Ip Endereço de locação reencambido tempo desembrulhado, renovação solicitada</span><span class="sxs-lookup"><span data-stu-id="60dbc-173">**NX_DHCP_STATE_REBINDING**: DHCP IP Address lease rebind time elapsed, renewal requested</span></span>
- <span data-ttu-id="60dbc-174">**NX_DHCP_STATE_FORCERENEW**: DhCP IP Endereço de arrendamento estabelecido, renovação de força por servidor ou por aplicação</span><span class="sxs-lookup"><span data-stu-id="60dbc-174">**NX_DHCP_STATE_FORCERENEW**: DHCP IP Address lease established, force renewal by server or by application</span></span>
- <span data-ttu-id="60dbc-175">**NX_DHCP_STATE_FAILED:** Nenhum servidor encontrado ou nenhuma resposta do servidor recebido</span><span class="sxs-lookup"><span data-stu-id="60dbc-175">**NX_DHCP_STATE_FAILED**: No server found or no response from server received</span></span>

## <a name="dhcp-additional-parameters"></a><span data-ttu-id="60dbc-176">Parâmetros adicionais do DHCP</span><span class="sxs-lookup"><span data-stu-id="60dbc-176">DHCP Additional Parameters</span></span>

<span data-ttu-id="60dbc-177">O NetX DHCP Server tem uma lista predefinição de parâmetros de opção que está definido na opção configurável NX_DHCP_DEFAULT_SERVER_OPTION_LISTin *nx_dhcp_server.h* para fornecer aos Clientes DHCP parâmetros de configuração de rede comuns/críticos, por exemplo, router ou endereço de gateway e servidor DNS para o Cliente DHCP.</span><span class="sxs-lookup"><span data-stu-id="60dbc-177">The NetX DHCP Server has a default list of option parameters which is set in the configurable option NX_DHCP_DEFAULT_SERVER_OPTION_LISTin *nx_dhcp_server.h* to supply DHCP Clients with common/critical network configuration parameters e.g. router or gateway address and DNS server for the DHCP Client.</span></span>

## <a name="dhcp-rfcs"></a><span data-ttu-id="60dbc-178">DHCP RFCs</span><span class="sxs-lookup"><span data-stu-id="60dbc-178">DHCP RFCs</span></span>

<span data-ttu-id="60dbc-179">O NetX DHCP Server está em conformidade com o RFC2132, RFC2131 e RFCs relacionados.</span><span class="sxs-lookup"><span data-stu-id="60dbc-179">NetX DHCP Server is compliant with RFC2132, RFC2131, and related RFCs.</span></span>
